version: "3.1"

intents:
  - greet
  - goodbye
  - help
  - request_field_recommendation
  - ask_reservation_process
  - ask_modify_reservation
  - ask_cancellation_policy
  - ask_pricing_info
  - show_previous_recommendations
  - ask_feedback_status
  - show_faqs
  - affirm
  - deny
  - SetSlots # payload usado por los botones de feedback

entities:
  - sport
  - location
  - surface
  - date
  - time
  - budget
  - skill_level
  - user_id

slots:
  user_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  user_role:
    type: text
    influence_conversation: false
    initial_value: "player"
    mappings:
      - type: controlled
  chatbot_session_id:
    type: text
    influence_conversation: false
    mappings:
      - type: controlled
  chat_theme:
    type: text
    influence_conversation: false
    initial_value: "Reservas y alquileres"
    mappings:
      - type: custom
  preferred_sport:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sport
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_sport
  preferred_location:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: location
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_location
  preferred_surface:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: surface
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_surface
  preferred_date:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: date
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_date
  preferred_start_time:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_start_time
  preferred_end_time:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_end_time
  preferred_budget:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: budget
  preferred_skill_level:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: skill_level
  feedback_rating:
    type: float
    influence_conversation: false
    mappings:
      - type: from_text
  example_questions:
    type: text
    influence_conversation: false
    initial_value: |
      - Â¿QuÃ© puedes hacer?
      - MuÃ©strame mis recomendaciones anteriores
      - Â¿Hay alguna promo para hoy?
    mappings:
      - type: controlled
  agent_name:
    type: text
    influence_conversation: false
    initial_value: "Chato Bot"
    mappings:
      - type: controlled

forms:
  field_recommendation_form:
    required_slots:
      - preferred_sport
      - preferred_date
      - preferred_start_time
      - preferred_end_time
      - preferred_location
      - preferred_surface

responses:
  utter_hello:
    - condition:
        - type: slot
          name: user_role
          value: admin
      text: "Â¡Hola! Soy Chato Bot. Estoy listo para ayudarle a gestionar las canchas y equipos de su empresa."
    - text: "Â¡QuÃ© fue, causa! Soy Chato Bot, te puedo ayudar para encontrar la mejor cancha."
    - text: "Â¡Hola! AquÃ­ Chato Bot, listo para ayudarte a armar la pichanga como se debe."
  utter_goodbye:
    - condition:
        - type: slot
          name: user_role
          value: admin
      text: "Ha sido un gusto ayudarle. Si necesita otra gestiÃ³n, aquÃ­ estarÃ©."
    - text: "Â¡Listo, causa! Que tu pichanga salga con todo."
    - text: "Â¡Nos vemos! Cuando quieras armamos otra cancha bravaza."
  utter_what_can_you_do:
    - text: |
        Puedo darte una mano con:
        - Recomendarte canchas segÃºn el barrio, horario y deporte que buscas.
        - Contarte cÃ³mo reservar, reprogramar o cancelar sin complicaciones.
        - Mostrarte tu historial de sugerencias y los comentarios que dejaste.
        - Avisarte sobre promos o detalles importantes de las sedes.
      metadata:
        rephrase: True
  utter_ask_field_recommendation_form_preferred_sport:
    - text: "Â¿QuÃ© deporte deseas jugar?"
  utter_ask_field_recommendation_form_preferred_date:
    - text: "Â¿Para quÃ© fecha necesitas la cancha? (formato AAAA-MM-DD)"
  utter_ask_field_recommendation_form_preferred_start_time:
    - text: "Â¿A quÃ© hora te gustarÃ­a empezar? (por ejemplo 19:00)"
  utter_ask_field_recommendation_form_preferred_location:
    - text: "Â¿En quÃ© distrito o zona prefieres jugar?"
  utter_ask_field_recommendation_form_preferred_surface:
    - text: "Â¿Tienes preferencia por alguna superficie (sintÃ©tico, grass, etc.)?"
  utter_reservation_process:
    - text: |
        Para reservar una cancha solo debes:
        1. Elegir el deporte y la sede que prefieras.
        2. Seleccionar fecha y horario disponibles.
        3. Confirmar la reserva y realizar el pago desde la app.
        Si necesitas ayuda en algÃºn paso, Â¡dÃ­melo!
  utter_modify_reservation:
    - text: |
        Puedes modificar tu reserva desde la secciÃ³n "Mis reservas" eligiendo una nueva fecha u hora disponible.
        Si la reserva ya estÃ¡ muy cerca, es posible que necesites apoyo del equipo de soporte.
  utter_cancellation_policy:
    - text: |
        Las cancelaciones se permiten hasta 24 horas antes del horario reservado.
        Si cancelas dentro de ese plazo, el saldo queda como crÃ©dito para tu siguiente reserva.
        Fuera de ese tiempo, contÃ¡ctanos para revisar tu caso.
  utter_pricing_info:
    - text: |
        El precio de cada cancha depende del deporte, la sede y la franja horaria.
        Cuando busques opciones te mostrarÃ© el costo por hora y promociones disponibles.
  utter_top_faqs:
    - text: |
        Puedes preguntarme sobre:

        - ğŸ“… Â¿CÃ³mo reservo una cancha desde la app?
        - ğŸ” Â¿QuÃ© hago si necesito cambiar o cancelar?
        - ğŸ’¸ Â¿CuÃ¡nto estÃ¡ la hora en determinada sede?
        - â­ Â¿CÃ³mo dejo feedback de mis partidos?
        - ğŸŸï¸ Â¿QuÃ© sedes tienen promos o disponibilidad especial?
      metadata:
        rephrase: True
  utter_ask_feedback_rating:
    - text: "Â¿CÃ³mo calificarÃ­as tu experiencia?"
      buttons:
        - title: "ğŸ‘ Excelente"
          payload: "/SetSlots(feedback_rating=thumbs_up)"
        - title: "ğŸ‘ PodrÃ­a mejorar"
          payload: "/SetSlots(feedback_rating=thumbs_down)"
  utter_thankyou_positive:
    - text: "Â¡Gracias por el comentario positivo! Seguiremos mejorando para ti."
    - text: "Â¡Genial! Nos alegra saber que disfrutaste el servicio."
    - text: "Â¡Muchas gracias! Tus buenos comentarios nos motivan a seguir creciendo."
  utter_thankyou_negative:
    - text: "Gracias por tu sinceridad. Revisaremos cÃ³mo mejorar tu prÃ³xima experiencia."
    - text: "Apreciamos tu feedback. Trabajaremos para ofrecerte un mejor servicio."
    - text: "Gracias por avisarnos. Tu comentario nos ayuda a mejorar."
  utter_default_fallback:
    - text: "No estoy seguro de haber entendido. Â¿PodrÃ­as reformular tu mensaje o darme mÃ¡s detalles?"
  utter_no_relevant_answer_found:
    - text: "Lo siento, por ahora no tengo una respuesta para eso. Â¿Quieres intentarlo con otra pregunta?"
      metadata:
        rephrase: True
  utter_welcome:
    - text: |
        Â¡Bienvenido! Soy {agent_name} ğŸ‘‹, el bot pichanguero que te ayuda a cuadrar canchas.

        Puedes empezar con preguntas como:
        {example_questions}
  utter_help:
    - text: "Â¿QuÃ© necesitas? AquÃ­ estoy para ayudarte con la cancha o la gestiÃ³n."
      metadata:
        rephrase: True

actions:
  - action_session_start
  - action_submit_field_recommendation_form
  - action_show_recommendation_history
  - action_check_feedback_status
  - action_close_chat_session

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

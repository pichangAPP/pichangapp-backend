version: "3.1"

intents:
  - greet
  - goodbye
  - help
  - request_field_recommendation
  - ask_reservation_process
  - ask_modify_reservation
  - ask_cancellation_policy
  - ask_pricing_info
  - show_previous_recommendations
  - ask_feedback_status
  - show_faqs
  - human_handoff
  - affirm
  - deny

entities:
  - sport
  - location
  - surface
  - date
  - time
  - budget
  - skill_level
  - user_id

slots:
  user_id:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: user_id
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: user_id
          - active_loop: feedback_status_form
            requested_slot: user_id
  chatbot_session_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  chat_theme:
    type: text
    influence_conversation: false
    initial_value: "Reservas y alquileres"
    mappings:
      - type: custom
  preferred_sport:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sport
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_sport
  preferred_location:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: location
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_location
  preferred_surface:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: surface
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_surface
  preferred_date:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: date
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_date
  preferred_start_time:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_start_time
  preferred_end_time:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
          - active_loop: field_recommendation_form
            requested_slot: preferred_end_time
  preferred_budget:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: budget
  preferred_skill_level:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: skill_level
  feedback_rating:
    type: categorical
    influence_conversation: false
    values:
      - thumbs_up
      - thumbs_down
    mappings:
      - type: from_llm
  confirm_human_handoff:
    type: categorical
    influence_conversation: false
    values:
      - "SÃ­"
      - "No"
    mappings:
      - type: from_llm
  example_questions:
    type: text
    influence_conversation: false
    initial_value: |
      - Â¿QuÃ© puedes hacer?
      - MuÃ©strame mis recomendaciones anteriores
      - ConÃ©ctame con un agente humano
    mappings:
      - type: controlled
  agent_name:
    type: text
    influence_conversation: false
    initial_value: "Chato Bot"
    mappings:
      - type: controlled

forms:
  field_recommendation_form:
    required_slots:
      - user_id
      - preferred_sport
      - preferred_date
      - preferred_start_time
      - preferred_location
      - preferred_surface
  feedback_status_form:
    required_slots:
      - user_id

responses:
  utter_hello:
    - text: "Â¡Hola! Soy Chato Bot, tu asistente de PichangApp listo para ayudarte con reservas y recomendaciones."
      metadata:
        rephrase: True
    - text: "Â¡Bienvenido! Soy Chato Bot. Â¿Listo para encontrar la mejor cancha para tu partido?"
    - text: "Â¡Hola! Chato Bot a tu servicio. CuÃ©ntame quÃ© necesitas y buscaremos la mejor opciÃ³n disponible."
  utter_goodbye:
    - text: "Â¡Gracias por contactarnos! Que tengas un gran partido."
    - text: "Â¡Hasta pronto! Si necesitas otra reserva, aquÃ­ estarÃ©."
    - text: "Listo, cualquier cosa vuelve a escribirme. Â¡Ã‰xitos en la cancha!"
    - text: "Gracias por usar PichangApp. Â¡Nos vemos!"
    - text: "Â¡CuÃ­date! Estoy disponible cuando quieras organizar otro encuentro."
  utter_what_can_you_do:
    - text: |
        Puedo ayudarte a:
        - Buscar canchas disponibles segÃºn tus preferencias.
        - Explicarte cÃ³mo reservar, modificar o cancelar.
        - Mostrarte tu historial de recomendaciones y feedback.
        - Conectarte con un agente humano si lo necesitas.
      metadata:
        rephrase: True
  utter_ask_field_recommendation_form_user_id:
    - text: "Para buscar canchas necesito tu ID de usuario en PichangApp. Â¿CuÃ¡l es?"
  utter_ask_field_recommendation_form_preferred_sport:
    - text: "Â¿QuÃ© deporte deseas jugar?"
  utter_ask_field_recommendation_form_preferred_date:
    - text: "Â¿Para quÃ© fecha necesitas la cancha? (formato AAAA-MM-DD)"
  utter_ask_field_recommendation_form_preferred_start_time:
    - text: "Â¿A quÃ© hora te gustarÃ­a empezar? (por ejemplo 19:00)"
  utter_ask_field_recommendation_form_preferred_location:
    - text: "Â¿En quÃ© distrito o zona prefieres jugar?"
  utter_ask_field_recommendation_form_preferred_surface:
    - text: "Â¿Tienes preferencia por alguna superficie (sintÃ©tico, grass, etc.)?"
  utter_ask_feedback_status_form_user_id:
    - text: "Perfecto, dime tu ID de usuario para revisar tus comentarios."
  utter_reservation_process:
    - text: |
        Para reservar una cancha solo debes:
        1. Elegir el deporte y la sede que prefieras.
        2. Seleccionar fecha y horario disponibles.
        3. Confirmar la reserva y realizar el pago desde la app.
        Si necesitas ayuda en algÃºn paso, Â¡dÃ­melo!
  utter_modify_reservation:
    - text: |
        Puedes modificar tu reserva desde la secciÃ³n "Mis reservas" eligiendo una nueva fecha u hora disponible.
        Si la reserva ya estÃ¡ muy cerca, es posible que necesites apoyo del equipo de soporte.
  utter_cancellation_policy:
    - text: |
        Las cancelaciones se permiten hasta 24 horas antes del horario reservado.
        Si cancelas dentro de ese plazo, el saldo queda como crÃ©dito para tu siguiente reserva.
        Fuera de ese tiempo, contÃ¡ctanos para revisar tu caso.
  utter_pricing_info:
    - text: |
        El precio de cada cancha depende del deporte, la sede y la franja horaria.
        Cuando busques opciones te mostrarÃ© el costo por hora y promociones disponibles.
  utter_top_faqs:
    - text: |
        Puedes preguntarme sobre:

        - ğŸ“… Â¿CÃ³mo reservo una cancha?
        - ğŸ” Â¿Puedo cambiar o cancelar una reserva?
        - ğŸ’¸ Â¿CuÃ¡nto cuesta jugar en determinada sede?
        - â­ Â¿CÃ³mo dejar feedback de mis partidos?
        - ğŸ§‘â€ğŸ¤â€ğŸ§‘ Â¿CÃ³mo contacto a un agente humano?
      metadata:
        rephrase: True
  utter_ask_feedback_rating:
    - text: "Â¿CÃ³mo calificarÃ­as tu experiencia?"
      buttons:
        - title: "ğŸ‘ Excelente"
          payload: "/SetSlots(feedback_rating=thumbs_up)"
        - title: "ğŸ‘ PodrÃ­a mejorar"
          payload: "/SetSlots(feedback_rating=thumbs_down)"
  utter_thankyou_positive:
    - text: "Â¡Gracias por el comentario positivo! Seguiremos mejorando para ti."
    - text: "Â¡Genial! Nos alegra saber que disfrutaste el servicio."
    - text: "Â¡Muchas gracias! Tus buenos comentarios nos motivan a seguir creciendo."
  utter_thankyou_negative:
    - text: "Gracias por tu sinceridad. Revisaremos cÃ³mo mejorar tu prÃ³xima experiencia."
    - text: "Apreciamos tu feedback. Trabajaremos para ofrecerte un mejor servicio."
    - text: "Gracias por avisarnos. Tu comentario nos ayuda a mejorar."
  utter_ask_confirm_human_handoff:
    - text: "Â¿Quieres que te conecte con un agente humano?"
      buttons:
        - payload: "/SetSlots(confirm_human_handoff=SÃ­)"
          title: "SÃ­, por favor"
        - payload: "/SetSlots(confirm_human_handoff=No)"
          title: "No, gracias"
  utter_transferring_to_human:
    - text: "Listo, te voy a derivar con un agente humano en unos momentos."
  utter_human_handoff_cancelled:
    - text: "Entendido, seguimos por aquÃ­. Â¿Hay algo mÃ¡s en lo que pueda ayudarte?"
      metadata:
        rephrase: True
  utter_transfer_to_manager:
    - text: "Voy a compartir el siguiente resumen de la conversaciÃ³n con el equipo de soporte:\n{summary}"
  utter_default_fallback:
    - text: "No estoy seguro de haber entendido. Â¿PodrÃ­as reformular tu mensaje o darme mÃ¡s detalles?"
  utter_no_relevant_answer_found:
    - text: "Lo siento, por ahora no tengo una respuesta para eso. Â¿Quieres intentarlo con otra pregunta?"
      metadata:
        rephrase: True
  utter_welcome:
    - text: |
        Â¡Hola! Soy {agent_name} ğŸ‘‹. Estoy aquÃ­ para ayudarte con tus reservas deportivas.

        Puedes empezar con preguntas como:
        {example_questions}
  utter_help:
    - text: "Â¿En quÃ© puedo ayudarte?"
      metadata:
        rephrase: True

actions:
  - action_submit_field_recommendation_form
  - action_show_recommendation_history
  - action_check_feedback_status
  - action_close_chat_session
  - action_human_handoff

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
